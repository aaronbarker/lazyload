/*!
 * lazyLoad
 * @description	loads images onto the page as you scroll down to them
 * @version		1.5.0 - 2014 / 05 / 15 
 * @author		Aaron Barker
 * @requires	ui.core.js (1.8+)
 * @copyright	Copyright 2013 by Intellectual Reserve, Inc.
 */
(function(a){"use strict";var b=a(window);a.widget("lds.lazyLoad",{options:{lazyClass:"lazy",doneClass:"lazyLoadDone",placeholder:"data:image/gif;base64,R0lGODlhAQABAPAAAAAAAAAAACH/C1hNUCBEYXRhWE1QRT94cGFja2V0IDE2MDZCIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkZERDQ1MzVGMkZGMTExRTFBQTE4OTE5ODk4MQAh+QQFAAAAACwAAAAAAQABAEACAkQBADs=",updateOnResize:true,secondaryScroll:"",attList:["src","width","height","alt","class"],threshold:300,resizeDelay:100,fadeSpeed:250,loadHidden:false,mustForce:false,srcs:["2x","desktop","mobile"],srcFallback:"desktop",tests:{"2x":function(){return window.devicePixelRatio>1},mobile:function(){return a(window).width()<600},desktop:function(){return a(window).width()>600}}},_create:function(){var c=this.options,d=this,e=d.element,f=d.widgetName,g=c.doneClass,h="img."+c.lazyClass,i;d.imageSelector=c.loadHidden?h:h+":visible";i=d.imageSelector;a(e).on("update."+f,h,function(b,c){var e=a(this);c=c===undefined?false:c;if(e.hasClass(g)){d.setSrc(e,d.getSrc(e),c)}else{d.checkLocation(this,c)}}).on("loadNow."+f,h,function(){d.loadNow(this)});b.add(c.secondaryScroll).on(["scroll","resize","orientationchange"].join("."+f+" "),function(){clearTimeout(d.scrollTimer);d.scrollTimer=setTimeout(function(){var e=a(i);if(!c.updateOnResize){e=e.not("."+g)}d.viewportHeight=b.height();d.viewportTopY=b.scrollTop();d.viewportWidth=b.width();d.viewportLeftX=b.scrollLeft();e.trigger("update."+f)},d.initialized?c.resizeDelay:0)});d.initialized=true},_init:function(){var c=this,d=c.element,e=c.options,f=c.widgetName,g="noscript."+e.lazyClass;c.viewportHeight=b.height();c.viewportTopY=b.scrollTop();c.viewportWidth=b.width();c.viewportLeftX=b.scrollLeft();a(g,d).each(function(){var b=a(this),c=a("<img>"),d=c.attr("height")||e.minHeight||"";e.attList.forEach(function(a){c.attr(a,b.data(a)||"")});c.data(b.data());c.addClass(e.lazyClass).attr("src",e.placeholder);c.height(d);b.replaceWith(c);c.css("opacity","0.01")});a(c.imageSelector,d).not("."+c.options.doneClass).each(function(){var b=a(this),d=c.getSrc(b),e=function(){try{return!!sessionStorage.getItem(d)}catch(a){return false}}();b.trigger("update."+f,e)});b.trigger("resize."+f)},checkLocation:function(b,c){var d=this.options,e=this,f,g=/iphone|ipod/i.test(navigator.userAgent.toLowerCase())?60:0,h=a(b),i=!d.mustForce&&!h.data("mustforce"),j=function(){var a=h.offset().top<e.viewportTopY+e.viewportHeight+d.threshold+g,b=h.offset().left<e.viewportLeftX+e.viewportWidth+d.threshold+g;return a&&b};if(c||(d.updateOnResize||!h.hasClass(d.doneClass))&&(d.loadHidden||h.is(":visible"))&&j()&&i){f=e.getSrc(h);e.setSrc(h,f,c);if(d.minHeight&&!h.data("height")){h.removeAttr("height")}h.addClass(d.doneClass)}},getSrc:function(a){var b=this.options,c,d;b.srcs.some(function(e){var f=a.data(e);d=typeof b.tests[e]==="function"?!!b.tests[e].call(a):!!b.tests[e];if(d&&f){c=f}return!!c});return c||a.data(b.srcFallback)},setSrc:function(a,b){var c=this.options,d=this;if(b&&b!==a.attr("src")){a.on("load",function(){a.stop(true).fadeTo(c.fadeSpeed,1)});a.fadeTo(c.fadeSpeed,.01).attr("src",b);if(!a.data("width")){a.removeAttr("width")}if(!a.data("height")){a.removeAttr("height")}try{sessionStorage.setItem(b,"loaded")}catch(e){}a.off("load.lazyLoad").on("load.lazyLoad",function(){d._trigger("onload",false,a)})}},loadNow:function(a){this.checkLocation(a,true)},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments);a(this.element).add(window).unbind("."+this.widgetName)}});a.extend(a.lds.lazyLoad,{version:"1.5.0"})})(jQuery);