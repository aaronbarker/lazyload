/*!
* lazyLoad
* @description	loads images onto the page as you scroll down to them
* @version		2.0.0 - 2014 / 09 / 11 
* @author		Aaron Barker
* @requires	ui.core.js (1.8+)
* @copyright	Copyright 2013 by Intellectual Reserve, Inc.
*/
(function(a,b,c,d){"use strict";var e=a(b),f="lazyLoad",g={lazyClass:"lazy",doneClass:"lazyLoadDone",placeholder:"data:image/gif;base64,R0lGODlhAQABAPAAAAAAAAAAACH/C1hNUCBEYXRhWE1QRT94cGFja2V0IDE2MDZCIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkZERDQ1MzVGMkZGMTExRTFBQTE4OTE5ODk4MQAh+QQFAAAAACwAAAAAAQABAEACAkQBADs=",updateOnResize:true,secondaryScroll:"",attList:["src","width","height","alt","class"],threshold:300,resizeDelay:100,fadeSpeed:250,loadHidden:false,mustForce:false,srcs:["2x","desktop","mobile"],srcFallback:"desktop",tests:{"2x":function(){return b.devicePixelRatio>1},mobile:function(){return a(b).width()<600},desktop:function(){return a(b).width()>600}}};function h(b,c){this.element=a(b);this.options=a.extend({},g,c);this._defaults=g;this._name=f;this.init()}a.extend(h.prototype,{init:function(){this._create();this._init()},_create:function(){var b=this.options,c=this,f=c.element,g=c.widgetName,h=b.doneClass,i="img."+b.lazyClass,j;c.imageSelector=b.loadHidden?i:i+":visible";j=c.imageSelector;a(f).on("update."+g,i,function(b,e){var f=a(this);e=e===d?false:e;if(f.hasClass(h)){c.setSrc(f,c.getSrc(f),e)}else{c.checkLocation(this,e)}}).on("loadNow."+g,i,function(){c.loadNow(this)});e.add(b.secondaryScroll).on(["scroll","resize","orientationchange"].join("."+g+" "),function(){clearTimeout(c.scrollTimer);c.scrollTimer=setTimeout(function(){var d=a(j);if(!b.updateOnResize){d=d.not("."+h)}c.viewportHeight=e.height();c.viewportTopY=e.scrollTop();c.viewportWidth=e.width();c.viewportLeftX=e.scrollLeft();d.trigger("update."+g)},c.initialized?b.resizeDelay:0)});c.initialized=true},_init:function(){var b=this,c=b.element,d=b.options,f=b.widgetName,g="noscript."+d.lazyClass;b.viewportHeight=e.height();b.viewportTopY=e.scrollTop();b.viewportWidth=e.width();b.viewportLeftX=e.scrollLeft();a(g,c).each(function(){var b=a(this),c=a("<img>"),e=c.attr("height")||d.minHeight||"";d.attList.forEach(function(a){c.attr(a,b.data(a)||"")});c.data(b.data());c.addClass(d.lazyClass).attr("src",d.placeholder);c.height(e);b.replaceWith(c);c.css("opacity","0.01")});a(b.imageSelector,c).not("."+b.options.doneClass).each(function(){var c=a(this),d=b.getSrc(c),e=function(){try{return!!sessionStorage.getItem(d)}catch(a){return false}}();c.trigger("update."+f,e)});e.trigger("resize."+f)},checkLocation:function(b,c){var d=this.options,e=this,f,g=/iphone|ipod/i.test(navigator.userAgent.toLowerCase())?60:0,h=a(b),i=!d.mustForce&&!h.data("mustforce"),j=function(){var a=h.offset().top<e.viewportTopY+e.viewportHeight+d.threshold+g,b=h.offset().left<e.viewportLeftX+e.viewportWidth+d.threshold+g;return a&&b};if(c||(d.updateOnResize||!h.hasClass(d.doneClass))&&(d.loadHidden||h.is(":visible"))&&j()&&i){f=e.getSrc(h);e.setSrc(h,f,c);if(d.minHeight&&!h.data("height")){h.removeAttr("height")}h.addClass(d.doneClass)}},getSrc:function(a){var b=this.options,c,d;b.srcs.some(function(e){var f=a.data(e);d=typeof b.tests[e]==="function"?!!b.tests[e].call(a):!!b.tests[e];if(d&&f){c=f}return!!c});return c||a.data(b.srcFallback)},setSrc:function(b,c){var d=this.options;if(c&&c!==b.attr("src")){b.on("load",function(){b.stop(true).fadeTo(d.fadeSpeed,1)});b.fadeTo(d.fadeSpeed,.01).attr("src",c);if(!b.data("width")){b.removeAttr("width")}if(!b.data("height")){b.removeAttr("height")}try{sessionStorage.setItem(c,"loaded")}catch(e){}b.off("load."+f).on("load."+f,function(){if(a.isFunction(d.onload)){d.onload.call(b,false)}})}},loadNow:function(a){this.checkLocation(a,true)}});a.fn[f]=function(b){this.each(function(){if(!a.data(this,"plugin_"+f)){a.data(this,"plugin_"+f,new h(this,b))}});return this};a.fn[f].version="2.0.0"})(jQuery,window,document);